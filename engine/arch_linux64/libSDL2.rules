
######################################################
#
# Build a static binary of libSDL2
#


lib_targets += libsdl2_build

libsdl2_base = SDL2
libsdl2_src  = $(lib_src)/$(libsdl2_base)
libsdl2_lib  = $(lib_dst)/libSDL2.a
libsdl2_tmp  = build/libSDL2


libsdl2_build: $(libsdl2_lib)
	$(eval cflags += -DHAVE_SDL2)
	$(eval libs   += SDL2)


$(libsdl2_lib): $(libsdl2_tgz)
	mkdir -p $(libsdl2_tmp)/build
	mkdir -p $(lib_dst)/include
	cp -Rp $(CURDIR)/$(libsdl2_src)/* $(libsdl2_tmp)/build/
	cd $(libsdl2_tmp)/build &&                         \
		CC="$(cc)" CFLAGS="$(cflags)" ./configure  \
			--prefix=$(abspath $(libsdl2_tmp)) \
			--enable-static                    \
			--disable-shared &&                \
		make all install
	@cp -Rv $(libsdl2_tmp)/include/* $(lib_dst)/include
	@cp -Rv $(libsdl2_tmp)/lib/lib*  $(lib_dst)/

